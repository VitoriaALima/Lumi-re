<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumiére - Cadastro de serviços</title>
    <link rel="stylesheet" href="assets/css/index.cadastroservico.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Playfair+Display:ital,wght@1,700&display=swap"
        rel="stylesheet">

    <script src="assets/js/seguranca.js" defer></script>

</head>


<body>
    <header>
        <img src="assets/img/logo.png" alt="LUMIÉRE - Beleza | Estética | Bem-estar" class="logo">
        <nav>
            <a class="logoutcabecalho" style="cursor: pointer;">LOGOUT</a>
            <a href="edicao_dados_ADM.html">EDIÇÃO DE DADOS</a>
            <a href="cadastroservico_ADM(profissional).html">CADASTRAR SERVIÇOS</a>
            <a href="index.cadastroservico_ADM.html">CADASTRAR AGENDAMENTO</a>
            <a href="painel_administrativo_ADM.html">PAINEL ADMINISTRATIVO</a>
            <a href="painel_profissional_ADM.html">PAINEL PROFISSIONAL</a>
            <a href="listagem_adm.html">LISTAGEM</a>
        </nav>
    </header>

    <section class="cadastro-container">
        <div class="decorative-line">
            <h1><span style="color:#fff;">Sucesso!</span></h1>
            <p class="subtitulo">Realize aqui o cadastro de seus serviços</p>
        </div>

        <!-- Formulário -->
        <form class="form-cadastro">

            <div class="form-group">
                <label for="descricao">DESCRIÇÃO</label>
                <input type="text" id="descricao" required>
            </div>
            <div class="form-group">
                <label for="valor">VALOR</label>
                <input type="number" id="valor" required>
            </div>
            <div class="form-group">
                <label for="duracao_horas">DURAÇÃO</label>
                <input type="time" id="duracao_horas" required>
            </div>
            <div class="form-group">
                <label for="categoria">CATEGORIA</label>
                <select id="categoria" class="selecionar" required>
                    <option value="">Selecione seu tipo ></option>
                    <option value="Cabelereiro(a)">Cabelereiro(a)</option>
                    <option value="Manicure e pedicure">Manicure e pedicure</option>
                    <option value="Maquiador(a)">Maquiador(a)</option>
                    <option value="Designer de sobrancelhas">Designer de sobrancelhas</option>
                </select>
            </div>


            <!-- aviso+botão ficam na 2ª coluna -->
            <div class="form-actions">
                <p class="aviso">*Verifique se todos os dados foram informados corretamente antes de enviar.</p>
                <button type="submit" class="btn-enviar">ENVIAR</button>
            </div>
        </form>
    </section>

    <footer class="footer">
        <div class="footer1">
            <div class="footer-left">
                <div class="contact">
                    <img src="assets/img/celular.icon.png" alt="Telefone" class="icon">
                    <span>(18)000000000</span>
                </div>
                <div class="contact">
                    <img src="assets/img/location-icon.png" alt="Localização" class="icon">
                    <span>Avenida das flores</span>
                </div>
            </div>

            <div class="footer-center">
                <img src="assets/img/logo.png" alt="Logo Lumiére" class="logo">
            </div>
        </div>
        <div class="footer-bottom">
            <span>© 2025. Todos os direitos reservados.</span>
        </div>
    </footer>


    <script>
        document.querySelector(".form-cadastro").addEventListener("submit", async (e) => {
            e.preventDefault();

            const descricao = document.getElementById("descricao").value;
            const valor = document.getElementById("valor").value;
            const duracao_horas = document.getElementById("duracao_horas").value;


            const dados = { descricao, valor, duracao_horas };

            try {
                const response = await fetch("http://10.92.3.171:5000/servico", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(dados)
                });

                if (response.ok) {
                    const result = await response.json();
                    Swal.fire({
                        icon: "success",
                        title: "Sucesso!",
                        text: result.message
                    }).then(() => {
                        window.location.href = "index.cadastroservico.html"; //redireciona
                    });
                } else {
                    const error = await response.json();
                    Swal.fire({
                        icon: "error",
                        title: "Oops...",
                        text: error.error || "Erro ao cadastrar serviço!"
                    });
                }
            } catch (err) {
                Swal.fire({
                    icon: "error",
                    title: "Falha na conexão",
                    text: "Não foi possível conectar ao servidor."
                });
            }
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const logoutBtn = document.querySelector('.btn-logout');

            if (!logoutBtn) {
                console.error('Botão de logout não encontrado (seletor .btn-logout).');
                return;
            }

            logoutBtn.addEventListener('click', function (e) {
                e.preventDefault();

                // Confirmação com SweetAlert2
                Swal.fire({
                    title: 'Deseja realmente sair?',
                    text: 'Você precisará fazer login novamente.',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'SIM',
                    cancelButtonText: 'NÃO',
                    reverseButtons: true
                }).then((result) => {
                    if (result.isConfirmed) {
                        try {
                            // Remova o token 
                            localStorage.removeItem('token');        // chave mais comum
                            sessionStorage.removeItem('token');      
                            

                            // Apagar cookie de sessão
                            document.cookie = 'session=; Max-Age=0; path=/;';

                            // Mensagem de sucesso e redirecionamento
                            Swal.fire({
                                icon: 'success',
                                title: 'Desconectado',
                                showConfirmButton: false,
                                timer: 1200
                            }).then(() => {
                                window.location.href = 'login.html';
                            });
                        } catch (err) {
                            console.error('Erro ao efetuar logout:', err);
                            Swal.fire('Erro', 'Não foi possível deslogar. Tente novamente.', 'error');
                        }
                    } else {
                        // usuário cancelou — não faz nada
                    }
                });
            });
        });
    </script>


</body>

</html>