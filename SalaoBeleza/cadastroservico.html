<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumi√©re - Cadastro de servi√ßos</title>
    <link rel="stylesheet" href="assets/css/index.cadastroservico.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Playfair+Display:ital,wght@1,700&display=swap"
        rel="stylesheet">

    <script src="assets/js/seguranca.js" defer></script>

</head>


<body>
    <header>
        <img src="assets/img/logo.png" alt="LUMI√âRE - Beleza | Est√©tica | Bem-estar" class="logo">
        <nav>
            <a class="btn-logout" style="cursor: pointer;">LOGOUT</a>
            <a href="edicao_dados.html">EDI√á√ÉO DE DADOS</a>
            <a href="cadastroservico.html">CADASTRAR SERVI√áOS</a>
            <a href="painel_profissional.html">PAINEL PROFISSIONAL</a>
            <a href="listagem.html">LISTAGEM</a>
        </nav>
    </header>

    <section class="cadastro-container">
        <div class="decorative-line">
            <h1><span style="color:#fff;">Sucesso!</span></h1>
            <p class="subtitulo">Realize aqui o cadastro de seus servi√ßos</p>
        </div>

        <!-- Formul√°rio -->
        <form class="form-cadastro">

            <div class="form-group">
                <label for="descricao">DESCRI√á√ÉO</label>
                <input type="text" id="descricao" required>
            </div>
            <div class="form-group">
                <label for="valor">VALOR</label>
                <input type="number" id="valor" required>
            </div>
            <div class="form-group">
                <label for="duracao_horas">DURA√á√ÉO</label>
                <input type="time" id="duracao_horas" required>
            </div>


            <!-- Agora o aviso+bot√£o ficam s√≥ na 2¬™ coluna -->
            <div class="form-actions">
                <p class="aviso">*Verifique se todos os dados foram informados corretamente antes de enviar.</p>
                <button type="submit" class="btn-enviar">ENVIAR</button>
            </div>
        </form>
    </section>

    <footer class="footer">
        <div class="footer1">
            <div class="footer-left">
                <div class="contact">
                    <img src="assets/img/phone-icon.png" alt="Telefone" class="icon">
                    <span>(18)000000000</span>
                </div>
                <div class="contact">
                    <img src="assets/img/location-icon.png" alt="Localiza√ß√£o" class="icon">
                    <span>Avenida das flores</span>
                </div>
            </div>

            <div class="footer-center">
                <img src="assets/img/logo.png" alt="Logo Lumi√©re" class="logo">
            </div>
        </div>
        <div class="footer-bottom">
            <span>¬© 2025. Todos os direitos reservados.</span>
        </div>
    </footer>


    <script>
        document.querySelector(".form-cadastro").addEventListener("submit", async (e) => {
            e.preventDefault();

            const descricao = document.getElementById("descricao").value;
            const valor = document.getElementById("valor").value;
            const duracao_horas = document.getElementById("duracao_horas").value;


            // üîπ Dados prontos para enviar
            const dados = { descricao, valor, duracao_horas };

            try {
                const response = await fetch("http://10.92.3.222:5000/servico", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(dados)
                });

                if (response.ok) {
                    const result = await response.json();
                    Swal.fire({
                        icon: "success",
                        title: "Sucesso!",
                        text: result.message
                    }).then(() => {
                        window.location.href = "painel_profissional.html"; //redireciona
                    });
                } else {
                    const error = await response.json();
                    Swal.fire({
                        icon: "error",
                        title: "Oops...",
                        text: error.error || "Erro ao cadastrar servi√ßo!"
                    });
                }
            } catch (err) {
                Swal.fire({
                    icon: "error",
                    title: "Falha na conex√£o",
                    text: "N√£o foi poss√≠vel conectar ao servidor."
                });
            }
        });
    </script>
   
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const logoutBtn = document.querySelector('.btn-logout');

            if (!logoutBtn) {
                console.error('Bot√£o de logout n√£o encontrado (seletor .btn-logout).');
                return;
            }

            logoutBtn.addEventListener('click', function (e) {
                e.preventDefault();

                // Confirma√ß√£o com SweetAlert2
                Swal.fire({
                    title: 'Deseja realmente sair?',
                    text: 'Voc√™ precisar√° fazer login novamente.',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'SIM',
                    cancelButtonText: 'N√ÉO',
                    reverseButtons: true
                }).then((result) => {
                    if (result.isConfirmed) {
                        try {
                            // Remova o token onde voc√™ o guarda
                            localStorage.removeItem('token');        // chave mais comum
                            sessionStorage.removeItem('token');      // caso use sessionStorage
                            // se quiser apagar tudo:
                            // localStorage.clear();

                            // Apagar cookie de sess√£o (opcional ‚Äî modifica conforme o nome do cookie)
                            document.cookie = 'session=; Max-Age=0; path=/;';

                            // Mensagem de sucesso curta e redirecionamento
                            Swal.fire({
                                icon: 'success',
                                title: 'Desconectado',
                                showConfirmButton: false,
                                timer: 1200
                            }).then(() => {
                                window.location.href = 'login.html';
                            });
                        } catch (err) {
                            console.error('Erro ao efetuar logout:', err);
                            Swal.fire('Erro', 'N√£o foi poss√≠vel deslogar. Tente novamente.', 'error');
                        }
                    } else {
                        // usu√°rio cancelou ‚Äî n√£o faz nada
                    }
                });
            });
        });
    </script>


</body>

</html>